/**
 * sofa-state-resolver-service - v0.4.1 - Wed Feb 18 2015 12:36:17 GMT+0100 (CET)
 * http://www.sofa.io
 *
 * Copyright (c) 2014 CouchCommerce GmbH (http://www.couchcommerce.com / http://www.sofa.io) and other contributors
 * THIS SOFTWARE CONTAINS COMPONENTS OF THE SOFA.IO COUCHCOMMERCE SDK (WWW.SOFA.IO)
 * IT IS PROVIDED UNDER THE LICENSE TERMS OF THE ATTACHED LICENSE.TXT.
 */
!function(e){"use strict";e.define("sofa.StateResolver",function(e,t,r){var n=r.get("apiEndpoint")+"states";return function(e){return t({method:"POST",url:n,data:e})}}),e.define("sofa.StateResolverService",function(t,r,n){var o={},s=new e.StateResolver(t,r,n),u=n.get("storeCode"),a=n.get("useShopUrls"),i={};return o.registerState=function(e){i[e.url]=e},o.resolveState=function(e){var r=t.defer();return a||"/"!==e.charAt(0)||(e=e.substr(1)),i[e]?r.resolve(i[e]):s({storeCode:u,url:e}).then(function(e){r.resolve(e.data)},function(){r.reject()}),r.promise},o})}(sofa,document);